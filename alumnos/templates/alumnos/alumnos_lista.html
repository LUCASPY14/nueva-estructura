{% extends 'base.html' %}
{% load static %}

{% block title %}Listado de Alumnos{% endblock %}

{% block content %}
<h1 class="text-2xl font-bold mb-6">📚 Alumnos Registrados</h1>

<!-- Mensajes de éxito/error -->
{% if messages %}
  <div class="mb-4 space-y-2">
    {% for message in messages %}
      <div class="p-3 rounded text-white {% if message.tags == 'success' %}bg-green-500{% elif message.tags == 'error' %}bg-red-500{% else %}bg-blue-500{% endif %}">
        {{ message }}
      </div>
    {% endfor %}
  </div>
{% endif %}

<div class="mb-6">
  <a href="{% url 'alumnos:crear_alumno' %}" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 transition">
    ➕ Agregar nuevo alumno
  </a>
</div>

<div class="overflow-x-auto bg-white shadow rounded">
  <table class="min-w-full table-auto border border-gray-300">
    <thead class="bg-green-600 text-white">
      <tr>
        <th class="px-4 py-2 text-left">Nombre</th>
        <th class="px-4 py-2 text-left">Padre</th>
        <th class="px-4 py-2 text-left">Grado</th>
        <th class="px-4 py-2 text-left">Nivel</th>
        <th class="px-4 py-2 text-left">Tarjeta</th>
        <th class="px-4 py-2 text-left">Acciones</th>
      </tr>
    </thead>
    <tbody>
      {% for alumno in alumnos %}
      <tr class="border-b hover:bg-gray-100">
        <td class="px-4 py-2">{{ alumno.nombre }}</td>
        <td class="px-4 py-2">{{ alumno.padre.get_full_name }}</td>
        <td class="px-4 py-2">{{ alumno.grado }}</td>
        <td class="px-4 py-2">{{ alumno.nivel }}</td>
        <td class="px-4 py-2">{{ alumno.numero_tarjeta|default:"-" }}</td>
        <td class="px-4 py-2 space-x-2">
          <a href="{% url 'alumnos:editar_alumno' alumno.pk %}" class="text-blue-600 hover:underline">✏️ Editar</a>
          <a href="{% url 'alumnos:detalle_alumno' alumno.pk %}" class="text-green-600 hover:underline">👁️ Ver</a>
          <a href="{% url 'alumnos:eliminar_alumno' alumno.pk %}" class="text-red-600 hover:underline" onclick="return confirm('¿Estás seguro que deseas eliminar este alumno?')">🗑️ Eliminar</a>
        </td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="6" class="text-center p-4 text-gray-500">No hay alumnos registrados.</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
